<!DOCTYPE html>
<html>
<head>
    <title>Mini ChatGPT</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        #output { margin-top: 20px; color: black; font-size: 18px; }
    </style>
</head>
<body>

<h2>Mini ChatGPT</h2>

<input id="question" placeholder="Ask something..." style="width:70%; padding:10px;">
<button onclick="askAI()">Ask AI</button>

<p id="output"></p>

<script>

// üî• AUTO BACKEND DETECT
async function getBackendURL() {
    let local = "http://localhost:8000";
    let mobile = "http://" + window.location.hostname + ":8000";

    // test local
    try {
        let r = await fetch(local + "/ask", {
            method: "POST",
            headers: {"Content-Type":"application/json"},
            body: JSON.stringify({question:"test"})
        });
        if (r.ok) return local;
    } catch (e) {}

    // test mobile IP
    try {
        let r = await fetch(mobile + "/ask", {
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body: JSON.stringify({question:"test"})
        });
        if (r.ok) return mobile;
    } catch (e) {}

    return null;
}

// üî• ASK AI
async function askAI() {
    let q = document.getElementById("question").value;
    let output = document.getElementById("output");

    output.innerHTML = "Thinking...";

    let backend = await getBackendURL();
    if (!backend) {
        output.innerHTML = "‚ùå Backend not found. Run: python app.py";
        return;
    }

    try {
        let res = await fetch(backend + "/ask", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({question: q})
        });

        let data = await res.json();
        output.innerHTML = "AI: " + data.answer;

    } catch (err) {
        output.innerHTML = "Error: " + err;
    }
}

</script>

</body>
</html>
